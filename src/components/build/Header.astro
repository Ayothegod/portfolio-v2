---
import { Icon } from "astro-icon/components";
import Link from "../ui/Link.astro";
import { Button } from "../ui/button";
import { mobileMenuIcons } from "../../lib/mobileMenu";

const currentUrl = Astro.url?.pathname;
// console.log(currentUrl)
---

<header class="flex justify-center">
  <Button id="darkModeToggle" variant="secondary">Toggle Mode</Button>
  <div
    class="fixed inset-x-0 bottom-6 rounded-2xl max-w-full mt-3 mx-4 p-3 bg-[rgba(0,0,0,.1)] dark:bg-[rgba(0,0,0,.4)] backdrop-blur-lg shadow-lg"
  >
    <div class="grid grid-cols-6 gap-4">
      {
        mobileMenuIcons.map((menu) => (
          <Link
            href={menu.href}
            text={false}
            styles={`p-2 rounded-lg text-2xl ${currentUrl === menu.href && "bg-[rgba(0,0,0,.1)] dark:bg-[rgba(225,225,225,.1)]"}`}
            icon={currentUrl === menu.href ? menu.activeIcon : menu.icon}
            iconPosition="left"
          />
        ))
      }
    </div>
  </div>
</header>

<script>
  import {
    $toggleTheme,
    $applyTheme,
    $currentTheme,
    $setThemePreference,
  } from "../../store/theme";

  const themeToggleButton = document.getElementById("darkModeToggle");
  const html = document.querySelector("html");

  window.addEventListener("DOMContentLoaded", () => {
    const currentTheme = $currentTheme.get();

    if (currentTheme === null) {
      $setThemePreference("dark");
    }
    $applyTheme();
  });

  if (themeToggleButton) {
    themeToggleButton.addEventListener("click", () => {
      $toggleTheme();
    });
  }
</script>
